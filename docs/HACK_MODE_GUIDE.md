# Hack 模式功能說明

## 概述

hack 模式是一個開發者作弊功能，按下 `0` 鍵可以開啟或關閉。開啟後會提供多種遊戲增強功能。

## 啟用方式

- **開啟/關閉**：按下 `0` 鍵
- **狀態顯示**：開啟時螢幕上方會顯示紫色的 hack 模式 UI

## 功能列表

### 1. 機關槍自動追蹤 🎯
- **功能**：使用機關槍時會自動瞄準最近的怪物
- **實現**：hack 模式下機關槍射擊會自動計算到最近怪物的方向
- **使用**：切換到機關槍（按 `1` 鍵），然後射擊會自動追蹤敵人

### 2. 狙擊槍無冷卻時間 ⚡
- **功能**：狙擊槍可以連續射擊，沒有冷卻限制
- **正常狀態**：狙擊槍射擊間隔為 1 秒
- **hack 模式**：可以連續快速射擊
- **使用**：切換到狙擊槍（按 `4` 鍵），然後可以連續射擊

### 3. 無限手榴彈 💣
- **功能**：手榴彈數量不會減少，可以無限投擲
- **正常狀態**：最多 10 顆手榴彈，用完需要重新開始
- **hack 模式**：投擲後手榴彈數量保持不變
- **使用**：按 `H` 鍵進入手榴彈模式，左鍵投擲，右鍵引爆

### 4. 必殺技無冷卻時間 ⚡
- **功能**：必殺技可以連續使用，沒有冷卻限制
- **正常狀態**：必殺技冷卻時間為 20 秒
- **hack 模式**：可以連續使用必殺技
- **使用**：按 `X` 鍵使用雷電追蹤必殺技

### 5. 無限血量 💖
- **功能**：玩家不會受到任何傷害，血量永遠保持滿血
- **正常狀態**：玩家會被怪物攻擊和環境傷害，血量歸零時遊戲結束
- **hack 模式**：玩家完全免疫所有傷害來源
- **效果**：與怪物碰撞、被投射物擊中、接觸尖刺等都不會造成傷害

### 6. 快速怪物生成 👹
- **功能**：每 0.5 秒自動生成 2 隻隨機類型的小怪
- **生成位置**：在玩家周圍 150-400 像素的隨機位置
- **怪物類型**：隨機選擇岩漿怪、水怪或龍捲風怪
- **數量限制**：最多同時存在 15 隻怪物，避免性能問題

## 視覺提示

### hack 模式 UI
當 hack 模式開啟時，會在螢幕中上方顯示：
- **標題**：🔧 HACK 模式啟用（紅色）
- **功能列表**：機關槍追蹤 | 狙擊槍無冷卻 | 無限手榴彈 | 必殺技無冷卻 | 無限血量 | 快速生怪（黃色）  
- **關閉提示**：按 0 鍵關閉 hack 模式（白色）
- **背景**：半透明紫色背景配紅色邊框

### 終端提示
- 開啟時：`🔧 hack 模式: 開啟`
- 關閉時：`🔧 hack 模式: 關閉`

## 技術實現

### 主要修改文件
1. **src/main.py**：
   - 添加 hack_mode 狀態管理
   - 添加 0 鍵事件處理
   - 添加 toggle_hack_mode() 方法
   - 添加 draw_hack_mode_ui() 方法

2. **src/entities/player.py**：
   - 添加 hack_mode 屬性
   - 修改射擊冷卻檢查（狙擊槍）
   - 修改必殺技冷卻檢查
   - 添加機關槍自動追蹤邏輯
   - 添加 find_nearest_monster_position() 方法

3. **src/entities/weapon.py**：
   - 添加 hack_mode 屬性到 WeaponManager
   - 修改手榴彈消耗邏輯

4. **src/systems/monster_manager.py**：
   - 添加 spawn_specific_monster() 方法
   - 支援指定位置生成特定類型怪物

### 核心邏輯
- **冷卻檢查**：使用 `if not self.hack_mode:` 包裝原有冷卻邏輯
- **自動追蹤**：在射擊方向計算中檢查 hack 模式和武器類型
- **無限資源**：修改資源消耗條件，hack 模式下跳過消耗
- **怪物生成**：使用計時器在 hack 模式下定期生成怪物

## 測試驗證

運行測試腳本可以驗證所有功能：

**基本功能測試**：
```bash
python3 test_hack_mode.py
```

**怪物生成測試**：
```bash
python3 test_hack_monster_spawn.py
```

測試涵蓋：
- ✅ 狀態切換
- ✅ 必殺技無冷卻
- ✅ 狙擊槍無冷卻  
- ✅ 無限手榴彈
- ✅ 機關槍自動追蹤
- ✅ 怪物自動生成
- ✅ 功能關閉後恢復正常

## 使用方式

1. 啟動遊戲：`python3 -m src.main`
2. 在遊戲中按 `0` 鍵開啟 hack 模式
3. 享受增強功能：
   - 機關槍（1鍵）自動追蹤
   - 狙擊槍（4鍵）無冷卻
   - 手榴彈（H鍵+左鍵）無限使用
   - 必殺技（X鍵）無冷卻
   - 自動生成怪物（每0.5秒2隻）
4. 再按 `0` 鍵關閉 hack 模式

## 注意事項

1. **遊戲平衡**：hack 模式會大幅降低遊戲難度，建議僅用於測試
2. **性能影響**：機關槍自動追蹤和快速生怪對性能有輕微影響
3. **怪物數量**：自動生成最多 15 隻怪物以避免性能問題
4. **保存狀態**：hack 模式狀態不會被保存，重新啟動遊戲後需要重新開啟
5. **兼容性**：hack 模式與所有現有功能兼容，不會影響正常遊戲邏輯